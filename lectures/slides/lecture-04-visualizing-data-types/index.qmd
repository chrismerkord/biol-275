---
title: |
  | Lecture 4
  | Visualizing Data Types
subtitle: "ABD 3e Chapter 2"
format: revealjs
---

## Why Graphs Matter

Graphs help us see patterns that are hard to detect in raw numbers.

They allow us to:

-   Summarize large amounts of data
-   Compare groups or values quickly
-   See trends, differences, and relationships

But different graphs highlight different things.\
Choosing the right graph is necessary to show the most important features of the data clearly.

## In data visualization, form follows data structure

The type of graph you choose should be determined by:

-   How many variables you have
-   Whether each variable is **categorical** or **numerical**
-   What relationship or pattern you want to reveal

## Distributions: Looking at One Variable

::::: columns
::: {.column width="50%"}
A [distribution]{.keyword} describes how the values of a single variable are spread out

When you make a **histogram** or **bar chart**, you are showing:

-   What values occur
-   How often each value occurs
-   Where values are common or rare
:::

::: {.column width="50%"}
Visualizing distributions helps you:

-   Understand typical values
-   See variability and spread
-   Detect skew, gaps, or unusual values

When you graph **one variable**, you are almost always graphing its distribution.
:::
:::::

## One Categorical Variable: [Barcharts]{.keyword}

::::: columns
::: {.column width="50%"}
**Goal:** Show how *observations* are distributed across *categories*

-   Each column represents a category
-   Height = frequency (number of observations)
-   Bars are separated (categories are distinct)
-   Bar height encodes frequency or proportion
-   Best practice: **order by frequency**
:::

::: {.column width="50%"}
```{r}
#| label: barchart-penguins
#| fig-height: 4
#| fig-width: 5
#| fig-cap: "Barchart showing how penguins observations are distributed among three species in the Palmer Penguins dataset (Horst et al. 2020)"

library(ggplot2)
library(forcats)
library(palmerpenguins, quietly = TRUE)

ggplot(penguins, aes(x = fct_infreq(species), fill = species)) +
  geom_bar() +
  scale_fill_manual(values = c("darkorange","purple","cyan4"), 
                    guide = FALSE) +
  theme_minimal(base_size = 15) +
  labs(
    x = "Species",
    y = "Number of penguins",
    title = "Distribution of penguins by species"
  )
```
:::
:::::

## Tables can be used if necessary

::::: columns
::: {.column width="50%"}
```{r}
#| label: penguins-table-code
#| eval: false
#| echo: true

library(gt)
library(dplyr)
library(palmerpenguins)

penguins |> 
  count(species) |> 
  arrange(desc(n)) |> 
  gt() |> 
  cols_label(
    species = "Species",
    n = "Number of penguins"
  )
```
:::

::: {.column width="50%"}
```{r}
#| label: penguins-table-graph
#| eval: true
#| echo: false

library(gt)
library(dplyr)
library(palmerpenguins)

penguins |> 
  count(species) |> 
  arrange(desc(n)) |> 
  gt() |> 
  cols_label(
    species = "Species",
    n = "Number of penguins"
  ) |> 
  tab_options(
    table.font.size = px(24)
  )
```
:::
:::::

## Order factors meaningfully

::::: columns
::: {.column width="50%"}
Ordinal variables:

-   use pre-defined order (e.g. months Jan-Dec)

Nominal variables:

-   Most interested in the largest categories

-   Order by frequency

-   Place catch-all category at the bottom

-   Swap axes to give category labels more room
:::

::: {.column width="50%"}
Example: Leading Causes of Death

![Bar chart before reordering.](images/clipboard-2541097321.png){width="279"}

![Bar chart after reordering.](images/clipboard-1373280282.png){width="278"}
:::
:::::

## Visualizing One Numerical Variable

::::: columns
::: {.column width="50%"}
**Goal:** Understand the *distribution* of values in a single numerical variable.

These graphs are used to show:

-   Where values are *concentrated* (center, location)
-   How *spread out* the data are (width, variation)
-   Whether the distribution is *symmetric* or *skewed*
:::

::: {.column width="50%"}
Common graph types:

-   Histograms
-   Density plots
-   Cumulative frequency distributions

When you graph one numerical variable, you are visualizing its *distribution*.
:::
:::::

## Example: Gettysburg Address

::::: columns
::: {.column width="50%"}
|                 |                     |
|-----------------|---------------------|
| **Word length** | **Number of words** |
| 1               | 7                   |
| 2               | 50                  |
| 3               | 60                  |
| 4               | 58                  |
| 5               | 34                  |
| 6               | 24                  |
| 7               | 15                  |
| 8               | 6                   |
| 9               | 10                  |
| 10              | 4                   |
| 11              | 3                   |
:::

::: {.column width="50%"}
Histograms visually describe summary tables

![Word length distribution in the Gettysburg address](images/clipboard-2018971871.png)
:::
:::::

## [Histograms]{.keyword} display the distribution of a *numerical* variable using columns

::::: columns
::: {.column width="50%"}
-   Values grouped into intervals called [bins]{.keyword}

-   Height = number of observations (frequency)

-   Show distribution shape

-   Show skewness or symmetry

-   Show gaps or unusual values

-   Bars touch
:::

::: {.column width="50%"}
```{r}
#| label: histogram-penguins
#| fig-height: 4
#| fig-width: 5
#| fig-cap: "Barchart showing the distribution of bill lengths for penguins in the Palmer Penguins dataset (Horst et al. 2020)"

library(ggplot2)
library(forcats)
library(palmerpenguins, quietly = TRUE)

penguins |> 
  filter(!is.na(bill_length_mm)) |> 
  ggplot(aes(x = bill_length_mm)) +
  geom_histogram(binwidth = 2, fill = "darkcyan") +
  theme_minimal(base_size = 15) +
  labs(
    x = "Bill Length (mm)",
    y = "Count",
    title = "Distribution of penguin bill lengths"
  )
```
:::
:::::

## Choosing Bin Widths

::::: columns
::: {.column width="50%"}
-   Bin width defines how numerical values are grouped
-   Different bin widths can reveal or obscure patterns
-   Bin widths should be chosen deliberately
-   Default settings are rarely optimal
:::

::: {.column width="50%"}
```{r}
#| label: histogram-narrow-bins
#| fig-height: 2.8
#| fig-width: 7
#| fig-cap: "A histogram with bins that are too narrow."


penguins |> 
  filter(!is.na(bill_length_mm)) |> 
  ggplot(aes(x = bill_length_mm)) +
  geom_histogram(bins=100, fill = "darkcyan") +
  theme_minimal(base_size = 15)
```

```{r}
#| label: histogram-wide-bins
#| fig-height: 2.8
#| fig-width: 7
#| fig-cap: "A histogram with bins that are too wide"


penguins |> 
  filter(!is.na(bill_length_mm)) |> 
  ggplot(aes(x = bill_length_mm)) +
  geom_histogram(bins=4, fill = "darkcyan") +
  theme_minimal(base_size = 15)
```
:::
:::::

## [Density plots]{.keyword} show the shape of a numerical distribution using a smooth curve

::::: columns
::: {.column width="50%"}
-   Same goal as histograms: reveal shape, center, spread, skew
-   No bins; based on a continuous density estimate
-   Emphasize overall patterns rather than exact counts
-   Well suited for comparing multiple groups on the same axis
-   Shape depends strongly on **bandwidth** (smoothing level)
-   Defaults can mislead — adjust bandwidth intentionally
:::

::: {.column width="50%"}
```{r}
#| label: density-penguins
#| fig-height: 4
#| fig-width: 5
#| fig-cap: "Density plot showing the distribution of bill lengths for penguins in the Palmer Penguins dataset (Horst et al. 2020)"

penguins |> 
  filter(!is.na(bill_length_mm)) |> 
  ggplot(aes(x = bill_length_mm)) +
  geom_density(fill = "darkcyan") +
  theme_minimal(base_size = 15) +
  labs(
    x = "Bill Length (mm)",
    y = "Density",
    title = "Distribution of penguin bill lengths"
  )
```
:::
:::::

## Cumulative frequency distributions show quantiles and cumulative proportions

::::: columns
::: {.column width="50%"}
-   Show the proportion of observations ≤ a given value
-   x-axis: data values; y-axis: cumulative proportion (0–1)
-   Quantiles read directly from the curve (median, quartiles, percentiles)
-   Always non-decreasing; ends at 1
-   Well suited for comparing distributions across groups
:::

::: {.column width="50%"}
```{r}
#| label: cdf-penguins
#| fig-height: 4
#| fig-width: 5
#| fig-cap: "Cumulative distribution function (CDF) of penguin bill lengths, showing the proportion of individuals with bill lengths less than or equal to a given value in the Palmer Penguins dataset (Horst et al. 2020)."

penguins |> 
  filter(!is.na(bill_length_mm)) |> 
  ggplot(aes(x = bill_length_mm)) +
  stat_ecdf(geom = "step") +
  theme_minimal(base_size = 15) +
  labs(
    x = "Bill Length (mm)",
    y = "Cumulative proportion",
    title = "Cumulative distribution of\npenguin bill lengths"
  )
```
:::
:::::

## CDFs are used when **how values accumulate** matters

::::: columns
::: {.column width="50%"}
-   Time-to-event data (e.g., survival, germination, development time)
-   Comparing entire distributions across populations or treatments
-   Evaluating biologically meaningful thresholds (e.g., size at maturity, tolerance limits)
-   Formal distribution comparisons (e.g., Kolmogorov–Smirnov tests)
:::

::: {.column width="50%"}
```{r}
#| label: cdf-example
#| fig-cap: "Kaplan–Meier survival curve (1 − CDF) for patients with advanced lung cancer, showing the proportion of individuals who have not yet experienced the event (death) over time. Each downward step corresponds to one or more observed events. Data are from the `lung` dataset in the R `survival` package (North Central Cancer Treatment Group)."

# Load required packages
library(survival)

# Load the lung survival dataset
data(lung)

# Recode status: 1 = censored, 2 = event (death)
lung$status_event <- lung$status == 2

# Fit Kaplan–Meier survival curve
km_fit <- survfit(Surv(time, status_event) ~ 1, data = lung)

# Convert to a data frame
km_df <- data.frame(
  time = km_fit$time,
  surv = km_fit$surv
)

# Plot 1 − CDF (i.e., survival function)
ggplot(km_df, aes(x = time, y = surv)) +
  geom_step(linewidth = 1, color = "darkblue") +
  labs(
    x = "Time (days)",
    y = "Proportion not yet experiencing event",
    title = "1 − CDF (survival curve) for lung cancer patients"
  ) +
  theme_minimal(base_size = 15)

```
:::
:::::

## Shapes of Distributions

Histograms, density plots, and cumulative frequency plots can reveal the shapes of distributions. This is important for understanding data and choosing a statistical approach.

## Distribution Shapes: Histograms

Bell-shaped Bimodal Skewed Uniform

## Distribution Shapes: Density plots

Bell-shaped Bimodal Skewed Uniform ![](images/slide-45-01.png)

## Distribution Shapes: Cumul. Freq. Distros.

Bell-shaped Bimodal Skewed Uniform ![](images/slide-46-01.png)

## Two Categorical Variables: Bar plots, Contingency Tables, and Mosaic Plots

Two Categorical Variables: Bar plots, Contingency Tables, and Mosaic Plots

## Two Categorical Variables—Goals

Visualize the association between variables. Example: Is Breeding Dangerous for Birds

## Is Breeding Dangerous for Birds?

Oppliger et al. (1996) removed eggs from some, but not other, *Parus* *major* nests to encourage them to breed more. They later assayed the moms for malaria. Here are the data as a **contingency table**.

## Visualization: Grouped Bar Graph

## Visualization: Stacked Bar Graph

## Visualization: Mosaic Plot

## One categorical and one numerical variable: Multiple histograms and Strip charts

## Example: Edgar Anderson’s Iris Data Set

Multiple Histograms This dataset is in R stats package print(iris)

## Avoid Over-plotting

Over-plotting hides data by placing data points on top of each other.

## Good Alternative: Strip Chart

To show data, data points are jittered about the x-axis. Note: The position on the x within groups is not meaningful.

## Another Alternative: Violin Plot

The shape of the “violins” reflects the distribution of the data.

## Two numerical variables: Scatterplots

## Two Numerical Variables—Goals

Visualize the association. Visualize the joint distribution.

## Two Continuous: Scatterplots

## Two Continuous + One Categorical: Scatterplot With Legend

## Two Continuous + One Categorical: Scatterplot Directly Label

## Two Continuous + One Categorical: Small Multiples

## Line Graphs Show Data Over Time

For temporal data, note all observations with a data point, and connect each point with a line. Points may be omitted for clarity if there are no gaps

## Color Code Maps to Show Spatial Data

Note: Maps need not refer to areas of land. For example, you can make a map of gene expression across the body.
